# MCU налаштування
MCU STM32F4xx STM32F411xx

FLASH_SIZE_KB 512
APJ_BOARD_ID 8101

# Flash
INT_FLASH_START 0x08000000
INT_FLASH_SIZE 512K

# Частота кварцу
OSCILLATOR_HZ 8000000
HSE_TYPE HSE_CRYSTAL

# PLL — необхідно для USB 48 MHz
PLL_M 8
PLL_N 192
PLL_P 2
PLL_Q 4
USBPLL 1

MCUCONF_SOURCE hwdef/common/stm32f411_mcuconf.h

# USB підтримка (USB CDC / VCP)
define HAL_USB_ENABLED 1
define HAL_USB_CDC 1
define HAL_USB_VENDOR_ID 0x1209
define HAL_USB_PRODUCT_ID 0x5741
define HAL_USB_PRODUCT "BlackPillF411"
define HAL_USB_MANUFACTURER "BlackPillF411"
define HAL_USB_SERIAL_NUMBER "0001"

CHIBIOS_BUILD_FLAGS USE_USB USE_OTG USE_FAT

PA11 OTG_FS_DM OTG1
PA12 OTG_FS_DP OTG1

SERIAL_ORDER OTG1 USART2 USART1
SERIAL_DEFAULT OTG1

# UART1
PA9  USART1_TX USART1 NODMA
PA10 USART1_RX USART1

# UART2
PA2  USART2_TX USART2 NODMA
PA3  USART2_RX USART2

# LED — на PC13
LED_PIN PC13
LED_INVERTED true

# I2C1
I2C1_SCL_PIN PB8
I2C1_SDA_PIN PB9
I2C_ORDER I2C1

# PWM — TIM3 (CH3, CH4)
PWM_TIMER TIM3
PWM_PIN PB0
PWM_PIN PB1
PWM_COUNT 2

# HRT
define HRT_TIMER TIM5

# ADC (наприклад, PA0)
ADC_PIN PA0
define HAL_ANALOG_ENABLED

# DMA для ADC1
define STM32_ADC_ADC1_DMA_STREAM STM32_DMA_STREAM_ID(2, 0)

# Bootloader не вшиваємо
define AP_BOOTLOADER_FLASHING_ENABLED 0

